# backend_dir/main.py

from fastapi import FastAPI
from spread_calculation import calculate_daily_spread

app = FastAPI()

@app.get("/compare_daily_spreads")
async def compare_daily_spreads():
    cdr_spread = calculate_daily_spread("CDR.WA")
    bits_spread = calculate_daily_spread("11B.WA")
    spread_difference = cdr_spread - bits_spread
    bigger_change = "CDR.WA" if cdr_spread > bits_spread else "11B.WA"
    return {"spread_difference": spread_difference, "bigger_change": f"{bigger_change} has a bigger daily spread change."}

if __name__ == "__main__":
    import uvicorn
    uvicorn.run(app, host="0.0.0.0", port=8000)